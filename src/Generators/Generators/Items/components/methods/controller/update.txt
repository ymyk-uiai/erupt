<!erupt
    model = self.files.model.class_name
    modelInstance = self.files.model.instance
    modelFullClass = self.files.model.fullClassName
    resourceUseAs = self.files.resource.use_as
    requestUpdateClass = self.files.request@update.class_name
    authInstance = auth.files.model.instance
!>

<!erupt
    print("public function update({} $request, {} ${})", requestUpdateClass, model, modelInstance)
!>
{
    <!erupt
        print("$this->authorize('update', ${})", modelInstance)
    !>

    $validated = $request->validated();

    <!erupt
        foreach self.attributes.fillable as fillable {
            print("${}->{} = $validated['{}']", modelInstance, fillable.name, fillable.name)
        }
    !>

    <!erupt
        print("$request->{}()->{}()->save(${})", authInstance, collectionInstance, modelInstance)
    !>

    <!erupt
        print("return new {}(${})", resourceUseAs, modelInstance)
    !>
}

<data>
{
    "name": "controller_update",
    "type": "php_class",
    "components": [],
    "use": [
        "<!erupt self.files.request@update.fullClassName !>",
        "<!erupt self.files.model.fullClassName !>",
        "<!erupt self.files.resource.full_use_as !>"
    ]
}
</data>